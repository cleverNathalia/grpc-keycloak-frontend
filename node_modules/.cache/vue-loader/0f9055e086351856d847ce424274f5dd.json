{"remainingRequest":"/home/admin/Documents/client-part2/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/admin/Documents/client-part2/src/App.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/admin/Documents/client-part2/src/App.vue","mtime":1581593212664},{"path":"/home/admin/Documents/client-part2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/admin/Documents/client-part2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/admin/Documents/client-part2/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/admin/Documents/client-part2/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/home/admin/Documents/client-part2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/admin/Documents/client-part2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCmltcG9ydCBWdWUgZnJvbSAidnVlIjsKLy8gQUREIFRIRSBORVcgQ09NUE9ORU5UUwppbXBvcnQgVXNlciBmcm9tICIuL2NvbXBvbmVudHMvVXNlci52dWUiOwppbXBvcnQgQWRtaW4gZnJvbSAiLi9jb21wb25lbnRzL0FkbWluLnZ1ZSI7CmltcG9ydCBOYXYgZnJvbSAiLi9jb21wb25lbnRzL05hdi52dWUiOwovLyBBREQgS0VZQ0xPQUsKaW1wb3J0IEtleWNsb2FrIGZyb20gIi4uL25vZGVfbW9kdWxlcy9rZXljbG9hay1qcy9kaXN0L2tleWNsb2FrIjsKLy9BREQgR1JQQwppbXBvcnQgeyBncnBjIH0gZnJvbSAiQGltcHJvYmFibGUtZW5nL2dycGMtd2ViIjsKLy9BREQgU1RVQlMKaW1wb3J0IHsgSGVsbG9SZXF1ZXN0LCBIZWxsb1JlcGx5IH0gZnJvbSAiQC9oZWxsby9zcmMvcHJvdG8vaGVsbG9fcGIiOwppbXBvcnQgeyBIZWxsb1NlcnZpY2UgfSBmcm9tICJAL2hlbGxvL3NyYy9wcm90by9oZWxsb19wYl9zZXJ2aWNlIjsKCmV4cG9ydCBkZWZhdWx0IFZ1ZS5leHRlbmQoewogIG5hbWU6ICJBcHAiLAoKICBjb21wb25lbnRzOiB7CiAgICBVc2VyLAogICAgQWRtaW4sCiAgICBOYXYKICB9LAoKICBkYXRhOiAoKSA9PiAoewogICAgY29tcG9uZW50TmFtZTogIiIsCiAgICBwZW9wbGVBcnI6IFtdLAogICAgcGVvcGxlSGVhZGVyOlsiSUQiLCAiTmFtZSIsICJBZGRyZXNzIiwgIlBob25lIl0sCiAgICByb2xlOiBTdHJpbmcsCiAgICBoZWFkZXJOYW1lOiBTdHJpbmcsCiAgICBpbml0T3B0aW9uczogewogICAgICByZWFsbTogICJrZXljbG9hay1kZW1vIiwKICAgICAgdXJsOiAiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2F1dGgvIiwKICAgICAgY2xpZW50SWQ6ICJ2dWUtdGVzdC1hcHAiCiAgICB9LAogICAga2V5Y2xvYWs6IEtleWNsb2FrKCkKICB9KSwKCiAgbWV0aG9kczogewogICAgLy8gbG9nT3V0KCk6IGFueXsKICAgICAgCiAgICAvLyAgIGNvbnNvbGUubG9nKCJMT0dPVVQiKTsKICAgIC8vICAgdGhpcy5rZXljbG9hay5sb2dvdXQoKTsKCiAgICAvLyB9LAogICAgbG9hZFBhZ2UoKTogYW55IHsKCiAgICAgIC8vIFRISVMgSVMgVEhFIENPUElFRCBDT0RFIEZST00gVEhFIEtFWUNMT0FLIEFETUlOSVNUUkFUSU9OIENPTlNPTEUuIEpVU1QgQURBUFQgSVQsIFNPIFRIQVQgSVQgTUFUSEVTIFRISVMgRk9STUFUCiAgICAgIHRoaXMua2V5Y2xvYWsgPSBLZXljbG9hayh0aGlzLmluaXRPcHRpb25zKTsKCiAgICAgIGxldCByb2xlcyA9ICIiOwoKICAgICAgdGhpcy5rZXljbG9hawogICAgICAgIC5pbml0KHsKICAgICAgICAgIG9uTG9hZDogImxvZ2luLXJlcXVpcmVkIgogICAgICAgIH0pCiAgICAgICAgLnN1Y2Nlc3MoKGF1dGg6IGFueSkgPT4gewoKICAgICAgICAgIC8vIENIRUNLIElGIFRIRSBVU0VSIElTIEFVVEhFTlRJQ0FURUQKICAgICAgICAgIGlmICghYXV0aCkgewogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygiU1VDQ0VTU0ZVTExZIEFVVEhFTlRJQ0FURUQiKTsKCiAgICAgICAgICAgIC8vIENIRUNLIFdIQVQgUk9MRVMgVEhFWSBIQVZFIEFORCBESVNQTEFZIFRIRSBDT01QT05FTlQgQUNDT1JESU5HIFRPIFRIRSBST0xFCiAgICAgICAgICAgIHJvbGVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmtleWNsb2FrLnRva2VuUGFyc2VkKSk7CiAgICAgICAgICAgIHRoaXMucm9sZSA9IHJvbGVzLnJlYWxtX2FjY2Vzcy5yb2xlczsKICAgICAgICAgICAgdGhpcy5jb21wb25lbnROYW1lID0gU3RyaW5nKHRoaXMucm9sZSk7CgogICAgICAgICAgICB0aGlzLmhlYWRlck5hbWUgPSB0aGlzLmNvbXBvbmVudE5hbWUgPT0gJ2FkbWluJz8gJ3B1cnBsZScgOiAndGVhbCc7CgogICAgICAgICAgICAvL01BS0UgR1JQQyBDQUxMIFRPIEJBQ0tFTkQKICAgICAgICAgICAgY29uc3QgcmVxID0gbmV3IEhlbGxvUmVxdWVzdCgpOwogICAgICAgICAgICByZXEuc2V0Um9sZShTdHJpbmcodGhpcy5yb2xlKSk7CgogICAgICAgICAgICBjb25zdCByZXBsID0gbmV3IEhlbGxvUmVwbHkoKTsKCiAgICAgICAgICAgIGdycGMuaW52b2tlKEhlbGxvU2VydmljZS5IZWxsbywgewogICAgICAgICAgICAgIHJlcXVlc3Q6IHJlcSwKICAgICAgICAgICAgICBob3N0OiAiaHR0cDovLzEyNy4wLjAuMTo5MDkwLyIsCiAgICAgICAgICAgICAgb25NZXNzYWdlOiAobWVzc2FnZTogSGVsbG9SZXBseSkgPT4gewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlJFQ0VJVkVEIERBVEEiLCBtZXNzYWdlLnRvT2JqZWN0KCkpOwogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZXNzYWdlLmFycmF5WzBdLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5wZW9wbGVBcnIucHVzaChtZXNzYWdlLmFycmF5WzBdW2ldKTsgICAgICAgICAKICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBvbkVuZDogKAogICAgICAgICAgICAgICAgY29kZTogZ3JwYy5Db2RlLAogICAgICAgICAgICAgICAgbXNnOiBzdHJpbmcgfCB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICB0cmFpbGVyczogZ3JwYy5NZXRhZGF0YQogICAgICAgICAgICAgICkgPT4gewogICAgICAgICAgICAgICAgaWYgKGNvZGUgPT09IGdycGMuQ29kZS5PSykgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQ0FMTCBXQVMgU1VDQ0VTU0ZVTEwiKTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coY29kZSk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRyYWlsZXJzKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDQUxMIEZBSUxFRCIpOwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjb2RlKTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobXNnKTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2codHJhaWxlcnMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gU0VUIFRIRSBUT0tFTiBJTiBUSEUgTE9DQUxTVE9SQUdFCiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidnVlLXRva2VuIiwgU3RyaW5nKHRoaXMua2V5Y2xvYWsudG9rZW4pKTsKICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKAogICAgICAgICAgICAidnVlLXJlZnJlc2gtdG9rZW4iLAogICAgICAgICAgICBTdHJpbmcodGhpcy5rZXljbG9hay5yZWZyZXNoVG9rZW4pCiAgICAgICAgICApOwoKICAgICAgICAgIC8vIEhBTkRMRSBUT0tFTiBUSU1FT1VUCiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgdGhpcy5rZXljbG9hawogICAgICAgICAgICAgIC51cGRhdGVUb2tlbig3MCkKICAgICAgICAgICAgICAuc3VjY2VzcyhyZWZyZXNoZWQgPT4gewogICAgICAgICAgICAgICAgaWYgKHJlZnJlc2hlZCkgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiVG9rZW4gUmVmcmVzaGVkIik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiVG9rZW4gTm90IFJlZnJlc2hlZCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLmVycm9yKCgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGYWlsZWQgVG8gUmVmcmVzaCBUb2tlbiIpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfSwgNjAwMDApOwogICAgICAgIH0pCiAgICAgICAgLmVycm9yKCgpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJBVVRIRU5USUNBVElPTiBGQUlMRUQiKTsKICAgICAgICB9KTsKCiAgICAgICAgLy8ga2V5Y2xvYWsubG9nb3V0KCk7CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5sb2FkUGFnZSgpOwogIH0KfSk7Cg=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;AAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <v-app>\n    <Nav v-bind:headerName=\"headerName\" v-bind:keycloak=\"keycloak\"/>\n    <!-- Call the correct components according to data -->\n    <v-content>\n      <component v-bind:is=\"componentName\" v-bind:peopleArr=\"peopleArr\" v-bind:peopleHeader=\"peopleHeader\"/>\n      <!-- <v-btn v-on:click=\"logOut\">LOGOUT</v-btn> -->\n    </v-content>\n    \n  </v-app>\n</template>\n \n<script lang=\"ts\">\nimport Vue from \"vue\";\n// ADD THE NEW COMPONENTS\nimport User from \"./components/User.vue\";\nimport Admin from \"./components/Admin.vue\";\nimport Nav from \"./components/Nav.vue\";\n// ADD KEYCLOAK\nimport Keycloak from \"../node_modules/keycloak-js/dist/keycloak\";\n//ADD GRPC\nimport { grpc } from \"@improbable-eng/grpc-web\";\n//ADD STUBS\nimport { HelloRequest, HelloReply } from \"@/hello/src/proto/hello_pb\";\nimport { HelloService } from \"@/hello/src/proto/hello_pb_service\";\n\nexport default Vue.extend({\n  name: \"App\",\n\n  components: {\n    User,\n    Admin,\n    Nav\n  },\n\n  data: () => ({\n    componentName: \"\",\n    peopleArr: [],\n    peopleHeader:[\"ID\", \"Name\", \"Address\", \"Phone\"],\n    role: String,\n    headerName: String,\n    initOptions: {\n      realm:  \"keycloak-demo\",\n      url: \"http://localhost:8080/auth/\",\n      clientId: \"vue-test-app\"\n    },\n    keycloak: Keycloak()\n  }),\n\n  methods: {\n    // logOut(): any{\n      \n    //   console.log(\"LOGOUT\");\n    //   this.keycloak.logout();\n\n    // },\n    loadPage(): any {\n\n      // THIS IS THE COPIED CODE FROM THE KEYCLOAK ADMINISTRATION CONSOLE. JUST ADAPT IT, SO THAT IT MATHES THIS FORMAT\n      this.keycloak = Keycloak(this.initOptions);\n\n      let roles = \"\";\n\n      this.keycloak\n        .init({\n          onLoad: \"login-required\"\n        })\n        .success((auth: any) => {\n\n          // CHECK IF THE USER IS AUTHENTICATED\n          if (!auth) {\n            window.location.reload();\n          } else {\n            console.log(\"SUCCESSFULLY AUTHENTICATED\");\n\n            // CHECK WHAT ROLES THEY HAVE AND DISPLAY THE COMPONENT ACCORDING TO THE ROLE\n            roles = JSON.parse(JSON.stringify(this.keycloak.tokenParsed));\n            this.role = roles.realm_access.roles;\n            this.componentName = String(this.role);\n\n            this.headerName = this.componentName == 'admin'? 'purple' : 'teal';\n\n            //MAKE GRPC CALL TO BACKEND\n            const req = new HelloRequest();\n            req.setRole(String(this.role));\n\n            const repl = new HelloReply();\n\n            grpc.invoke(HelloService.Hello, {\n              request: req,\n              host: \"http://127.0.0.1:9090/\",\n              onMessage: (message: HelloReply) => {\n                console.log(\"RECEIVED DATA\", message.toObject());\n                for (let i = 0; i < message.array[0].length; i++) {\n                    this.peopleArr.push(message.array[0][i]);         \n                }             \n              },\n              onEnd: (\n                code: grpc.Code,\n                msg: string | undefined,\n                trailers: grpc.Metadata\n              ) => {\n                if (code === grpc.Code.OK) {\n                  console.log(\"CALL WAS SUCCESSFULL\");\n                  console.log(code);\n                  console.log(msg);\n                  console.log(trailers);\n                } else {\n                  console.log(\"CALL FAILED\");\n                  console.log(code);\n                  console.log(msg);\n                  console.log(trailers);\n                }\n              }\n            });\n          }\n\n          // SET THE TOKEN IN THE LOCALSTORAGE\n          localStorage.setItem(\"vue-token\", String(this.keycloak.token));\n          localStorage.setItem(\n            \"vue-refresh-token\",\n            String(this.keycloak.refreshToken)\n          );\n\n          // HANDLE TOKEN TIMEOUT\n          setTimeout(() => {\n            this.keycloak\n              .updateToken(70)\n              .success(refreshed => {\n                if (refreshed) {\n                  console.log(\"Token Refreshed\");\n                } else {\n                  console.log(\"Token Not Refreshed\");\n                }\n              })\n              .error(() => {\n                console.log(\"Failed To Refresh Token\");\n              });\n          }, 60000);\n        })\n        .error(() => {\n          console.log(\"AUTHENTICATION FAILED\");\n        });\n\n        // keycloak.logout();\n    }\n  },\n  mounted() {\n    this.loadPage();\n  }\n});\n</script>"]}]}